# CSRF（クロスサイトリクエストフォージェリ）

CSRF（シーサーフ、または、クロスサイトリクエストフォージェリ）とは、「利用者が意図しないリクエストを、利用者のブラウザから勝手に送信させる」攻撃

ログインしているウェブサイト（例えばネットバンキングやECサイト）に対して、悪意のあるウェブサイトがあなたのブラウザを通して、知らないうちに重要な操作（送金、商品の購入、パスワード変更など）を勝手に行わせてしまう攻撃

## 攻撃の仕組み

攻撃の仕組みは、主に以下のステップで成り立っている

1. ターゲットとなるウェブサイトにログイン済みのユーザーがいること: 攻撃者は、ユーザーがターゲットとなるウェブサイト（例えば `target.com` ）にログインしており、そのセッションが有効であることを前提する

2. 悪意のあるウェブサイトを用意する: 攻撃者は、例えば `evil.com` といった悪意のあるウェブサイトを作成する

3. 悪意のあるウェブサイトに誘導する: 攻撃者は、フィッシングメールや掲示板への書き込みなどを利用して、ターゲットユーザを `evil.com` に誘導する

4. ブラウザが勝手にリクエストを送信する: `evil.com` のページには、`target.com` に対する「罠」が仕掛けられている。例えば、ユーザには見えない `<img>` タグや `<iframe>` タグの `src` 属性に、`target.com` の重要な操作（例えば、パスワード変更のリクエスト）のURLが記述されている

5. 罠が実行される: ユーザが `evil.com` を閲覧すると、ユーザのブラウザは、そのページに含まれる `<img>` や `<iframe>` タグの `src` 属性に書かれた `target.com` へのリクエストをユーザがログイン中のセッション情報（クッキーなど）と一緒に勝手に送信してしまう

6. 意図しない操作が実行される: `target.com` は、正規のユーザからのリクエストだと誤解し、そのリクエストを受け入れて処理してしまう。結果として、ユーザは意図しないパスワード変更や送金などの操作が行われてしまう

## CSRFの危険性の特徴

1. ユーザが気づきにくい: ユーザは自分が何か操作したという意識がないため、攻撃を受けているとに気づきにくい

2. 正規のユーザとして処理される: 攻撃はユーザのブラウザを経由して行われるため、ターゲットのウェブサイトからは正規のユーザからのリクエストに見えてしまう
